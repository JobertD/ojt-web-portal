<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Home - OJT Portal</title>

   <!-- font awesome cdn link  -->
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css">

   <!-- custom css file link  -->
   <link rel="stylesheet" type="text/css" href="/css/style.css">

</head>
<body>
<header class="header">
   
   <section class="flex">

      <a href="/homepage" class="logo">OJT Portal</a>


      <div class="icons">
         <div id="menu-btn" class="fas fa-bars"></div> 
         <div id="search-btn" class="fas fa-search"></div>
         <div id="toggle-btn" class="fas fa-sun"></div>
      </div>

   </section>

</header>   

<div class="side-bar">

   <div id="close-btn">
      <i class="fas fa-times"></i>
   </div>

   <div class="profile">
      <img src="/images/pic-1.jpg" class="image" alt="">
      <h1 class="name"><%= fullName %></h1>
      <p class="role">Teacher</p>
      <a href="/profile" class="btn">view profile</a>
   </div>

   <nav class="navbar">
      <a href="/homepage"><i class="fas fa-home"></i><span>Home</span></a>
      <a href="/manage-students"><i class="fa-solid fa-briefcase"></i><span>Manage Students</span></a>
      <a href="/company-details"><i class="fa-solid fa-door-open"></i><span>Company Details</span></a>
      <a href="/logout"><i class="fa-solid fa-door-open"></i><span>Log Out</span></a>
    </nav>

</div>

<section class="manage-grid">
   <div class="manage-container">
       <div class="box">
           <h1 class="title">Student List</h1>
           <form id="filterForm">
               <label for="searchQuery">Search:</label>
               <input type="text" id="searchQuery" name="searchQuery" placeholder="Enter search query...">
               <button type="button" onclick="submitSearch()">Search</button>
           </form>
           <table id="studentTable">
               <thead>
                   <tr>
                       <th>Student ID</th>
                       <th>Name</th>
                       <th>Email</th>
                       <th>Course</th>
                       <th>Class Code</th>
                       <th>Company</th>
                   </tr>
               </thead>
               <tbody id="tableBody"></tbody>
           </table>
       </div>
   </div>

<script>
    window.onload = function () {
      fetchAllStudents();
   }

   function fetchAllStudents() {
      fetch('/fetch-all-students')
         .then(response => response.json())
         .then(data => populateTable(data))
         .catch(error => console.error('Error:', error));
   }

   function submitSearch() {
      const searchQuery = document.getElementById('searchQuery').value.trim();
      fetch(`/search-students?query=${searchQuery}`)
         .then(response => response.json())
         .then(data => populateTable(data))
         .catch(error => console.error('Error:', error));
   }

   function populateTable(data) {
      const tableBody = document.getElementById('tableBody');
      tableBody.innerHTML = ''; 

      data.forEach(student => {
         const row = document.createElement('tr');
         row.innerHTML = `
            <td>${student.studentId}</td>
            <td>${student.fullName}</td>
            <td>${student.email}</td>
            <td>${student.course}</td>
            <td>${student.classCode}</td>
            <td>${student.company}</td>
         `;
         tableBody.appendChild(row);
      });
   }
</script>
<div class="manage-container">
   <div class="box">
       <h1 class="title">Manage Student</h1>
       <h5>Requirements</h5>
       <ul>
           <!-- Requirements checklist items will be populated dynamically -->
       </ul>

       <h5>Reports to be reviewed</h5>
       <ul>
           <!-- Report details will be populated dynamically -->
       </ul>

       <h5>Reports History</h5>
       <ul>
           <!-- Report history will be populated dynamically -->
       </ul>
   </div>
</div>
</section>
     
<footer class="footer">

   &copy; Copyright @ 2023 by <span>The Croods</span> | All rights reserved!

</footer>
<script src="/js/script.js"></script>
<script>
   console.log('fullName:', '<%= fullName %>');
</script>

   
</body>
</html>